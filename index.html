<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Purdue Men's Basketball News</title>
  <style>
    :root {
      --bg-main: #000;
      --bg-card: #1a1a1a;
      --bg-card-grad: radial-gradient(circle at 20% 0%, rgba(255,255,255,0.08) 0%, rgba(0,0,0,0) 70%);
      --text-primary: #fff;
      --text-secondary: #cfcfcf;
      --text-dim: #9a9a9a;
      --accent-gold: #cbb36a;
      --border-card: rgba(255,255,255,0.07);
      --border-top: #cbb36a33;
    }

    body {
      margin: 0;
      background-color: var(--bg-main);
      color: var(--text-primary);
      font-family: -apple-system, BlinkMacSystemFont, "Inter", system-ui, Roboto, "Helvetica Neue", Arial, sans-serif;
      line-height: 1.4;
      -webkit-font-smoothing: antialiased;
    }

    .page-shell {
      display: flex;
      flex-direction: column;
      min-height: 100vh;
    }

    /* HEADER */
    .header-bar {
      background-color: #000;
      border-bottom: 1px solid var(--border-top);
      padding: 16px 16px 12px;
      display: flex;
      flex-wrap: wrap;
      align-items: flex-start;
      justify-content: space-between;
      gap: 12px;
    }

    .header-left {
      display: flex;
      flex-direction: row;
      align-items: flex-start;
      gap: 12px;
      flex: 1;
      min-width: 0;
    }

    .p-logo {
      background-color: #d8c691;
      color: #000;
      font-weight: 600;
      font-size: 20px;
      line-height: 1;
      font-family: Georgia, "Times New Roman", serif;
      border-radius: 8px;
      padding: 10px 14px;
      align-self: flex-start;
      flex-shrink: 0;
      box-shadow: 0 8px 24px rgba(0,0,0,0.6);
    }

    .title-block {
      display: flex;
      flex-direction: column;
      min-width: 0;
    }

    .title-line {
      color: var(--accent-gold);
      font-size: 16px;
      font-weight: 600;
      line-height: 1.3;
    }

    .subtitle-line {
      color: var(--text-primary);
      font-size: 18px;
      font-weight: 600;
      line-height: 1.3;
    }

    .updated-pill {
      background-color: rgba(255,255,255,0.05);
      border: 1px solid rgba(255,255,255,0.15);
      border-radius: 6px;
      color: var(--text-primary);
      font-size: 13px;
      font-weight: 500;
      line-height: 1.2;
      padding: 6px 10px;
      white-space: nowrap;
      align-self: flex-start;
    }

    /* FEED GRID */
    .feed-wrapper {
      flex: 1;
      background-color: #000;
      background-image: radial-gradient(circle at 50% 0%, rgba(255,255,255,0.07) 0%, rgba(0,0,0,0) 70%);
      padding: 16px;
    }

    .feed-grid {
      display: grid;
      grid-template-columns: 1fr;
      gap: 16px;
      max-width: 1400px;
      margin: 0 auto;
    }

    @media(min-width:700px){
      .feed-grid {
        grid-template-columns: repeat(2,1fr);
      }
    }
    @media(min-width:1100px){
      .feed-grid {
        grid-template-columns: repeat(3,1fr);
      }
    }

    /* CARD */
    .card {
      background-color: var(--bg-card);
      background-image: var(--bg-card-grad);
      border-radius: 12px;
      border: 1px solid var(--border-card);
      box-shadow: 0 20px 40px rgba(0,0,0,0.8);
      padding: 16px 16px 20px;
      display: flex;
      flex-direction: column;
      cursor: pointer;
      transition: transform 0.1s ease, box-shadow 0.1s ease;
    }

    .card:hover {
      transform: translateY(-3px);
      box-shadow: 0 24px 50px rgba(0,0,0,0.9);
    }

    .card-source-row {
      display: flex;
      align-items: baseline;
      justify-content: space-between;
      margin-bottom: 10px;
    }

    .card-source {
      color: var(--accent-gold);
      font-size: 14px;
      font-weight: 600;
    }

    .card-date {
      font-size: 13px;
      color: var(--text-dim);
    }

    .card-headline {
      font-size: 18px;
      font-weight: 600;
      color: var(--text-primary);
      line-height: 1.35;
      margin: 0 0 10px;
      word-break: break-word;
    }

    .card-blurb {
      font-size: 15px;
      color: var(--text-secondary);
      margin: 0;
      line-height: 1.45;
      word-break: break-word;
    }

    /* FOOTER */
    .footer-shell {
      border-top: 1px solid var(--border-top);
      background-color: #000;
      padding: 24px 16px 48px;
      color: var(--text-primary);
    }

    .footer-inner {
      max-width: 1400px;
      margin: 0 auto;
    }

    .footer-headline {
      font-size: 18px;
      font-weight: 600;
      margin: 0 0 8px;
      color: var(--text-primary);
    }

    .footer-desc {
      font-size: 16px;
      color: var(--text-secondary);
      margin: 0 0 20px;
    }

    .footer-sources-label {
      font-size: 16px;
      font-weight: 600;
      margin: 0 0 6px;
    }

    .footer-sources {
      font-size: 14px;
      color: var(--text-dim);
      line-height: 1.5;
    }
  </style>
</head>
<body>
<div class="page-shell">

  <header class="header-bar">
    <div class="header-left">
      <div class="p-logo">P</div>
      <div class="title-block">
        <div class="title-line">Purdue Boilermakers</div>
        <div class="subtitle-line">Men’s Basketball News</div>
      </div>
    </div>
    <div class="updated-pill"><span id="updated-label">Updated …</span></div>
  </header>

  <main class="feed-wrapper">
    <section id="feed" class="feed-grid"></section>
  </main>

  <footer class="footer-shell">
    <div class="footer-inner">
      <p class="footer-headline">Purdue Men's Basketball Fan Feed</p>
      <p class="footer-desc">Unofficial. Automatically surfaces the latest Purdue hoops headlines.</p>
      <p class="footer-sources-label">Sources we monitor:</p>
      <p class="footer-sources" id="sources-list"></p>
    </div>
  </footer>

</div>

<script>
(async function(){
  const decode = (str='') => str
    .replace(/&#39;/g,"'")
    .replace(/&quot;/g,'"')
    .replace(/&amp;/g,"&")
    .replace(/&nbsp;/g," ")
    .trim();

  try {
    const resp = await fetch('./static/teams/purdue-mbb/items.json?cache=' + Date.now());
    const data = await resp.json();

    const feedEl = document.getElementById('feed');
    const updatedEl = document.getElementById('updated-label');
    const sourcesEl = document.getElementById('sources-list');

    // Updated time
    if (data.last_updated) {
      const d = new Date(data.last_updated);
      if (!isNaN(d)) {
        const timeStr = d.toLocaleTimeString([], {hour:'numeric',minute:'2-digit'});
        updatedEl.textContent = `Updated ${timeStr}`;
      } else {
        updatedEl.textContent = 'Updated just now';
      }
    } else updatedEl.textContent = 'Updated just now';

    // Footer sources
    if (Array.isArray(data.sources) && data.sources.length > 0) {
      sourcesEl.textContent = data.sources.join(' · ');
    } else {
      sourcesEl.textContent = [
        "GoldandBlack.com",
        "On3 Purdue Basketball",
        "247Sports Purdue Basketball",
        "Purdue Athletics MBB",
        "ESPN Purdue MBB",
        "Yahoo Sports College Basketball",
        "CBS Sports College Basketball",
        "The Field of 68",
        "SI Purdue Basketball",
        "USA Today Purdue Boilermakers"
      ].join(' · ');
    }

    // Cards
    if (Array.isArray(data.items)) {
      const items = data.items.slice(0,40);
      items.forEach(item=>{
        const source = decode(item.source || '');
        const title = decode(item.title || '');
        const summary = decode(item.summary || '');
        const url = item.url || '#';

        let dateStr = '';
        if (item.published) {
          const d = new Date(item.published);
          if (!isNaN(d)) {
            const diff = Date.now() - d.getTime();
            const hrs = Math.floor(diff/3600000);
            if (hrs < 1) dateStr = 'Just now';
            else if (hrs < 24) dateStr = `${hrs}h ago`;
            else {
              const days = Math.floor(hrs/24);
              dateStr = `${days}d ago`;
            }
          }
        }

        const card = document.createElement('article');
        card.className = 'card';
        card.innerHTML = `
          <div class="card-source-row">
            <div class="card-source">${source}</div>
            <div class="card-date">${dateStr}</div>
          </div>
          <h2 class="card-headline">${title}</h2>
          <p class="card-blurb">${summary}</p>
        `;
        card.onclick = ()=>window.open(url,'_blank','noopener,noreferrer');
        feedEl.appendChild(card);
      });
    }
  } catch(e){
    console.error('Render error:',e);
  }
})();
</script>

</body>
</html>
